<!doctype html>
<html>
  <head>
    <!-- <script src="https://code.jquery.com/jquery-3.3.1.js"></script> -->
  </head>
  <body>
    <script>
       function allTiming() {
          console.log('all time');
          var resourceList = window.performance.getEntries();
          for (var i = 0; i < resourceList.length; i++) {
            console.log(resourceList[i],(resourceList[i].responseEnd - resourceList[i].startTime));
          }
          console.log(resourceList.length);
       }

       setTimeout(() => { allTiming(); }, 4000);

    </script>

  <div id="main-content" style="height: 1000px">
    <!-- <img id="image0" src="https://www.w3.org/Icons/w3c_home.png"> -->
    <img style="width: 100px;" src="http://static.ngs.ru/news/99/preview/dc327202c3050f5c5a853a46be04459104728e85_1500.jpg">
    <img style="width: 100px;" src="http://static.ngs.ru/news/99/preview/27125e7eec5c81f4b0787688839a9c1575af73ae_3000.jpg">
    <img style="width: 100px;" src="http://static.ngs.ru/news/99/preview/27125e7eec5c81f4b0787688839a9c1575af73ae_3000.jpg">
    <img style="width: 100px;" src="http://static.ngs.ru/news/99/preview/27125e7eec5c81f4b0787688839a9c1575af73ae_3000.jpg">
    <img style="width: 100px;" src="http://static.ngs.ru/news/99/preview/27125e7eec5c81f4b0787688839a9c1575af73ae_3000.jpg">
    <img style="width: 100px;" src="http://static.ngs.ru/news/99/preview/312e42c0919b918fe878ade84d97671671f03166_3000.jpg">
    <img style="width: 100px;" src="http://static.ngs.ru/news/99/preview/19962723ad11b9dfd88904bd8a0b93610bf739d1_1200.jpg">
    <img style="width: 100px;" src="http://static.ngs.ru/news/99/preview/603360bf10542ae1b090012298b6510172ca8698_1500.jpg">
  </div>

  <div id="sub-content">
    <video width="435" height="245" src="https://gcdn.2mdn.net/videoplayback/id/39cdf0d95ebeab1f/itag/347/source/doubleclick_dmm/ratebypass/yes/acao/yes/ip/0.0.0.0/ipbits/0/expire/3670833153/sparams/id,itag,source,ratebypass,acao,ip,ipbits,expire/signature/757BF4DCF5420FB4FA8FE2D94B76C2F804452D5E.582B6E7648F0BC9FEE11F11EEDEF4F462DF97CE0/key/ck2/file/file.mp4" preload="auto"></video>
  </div>
    <!--
      ttfmp_rAF_1 24.10000000054424
      ttfmp_rAF_2 38.30000000016298
      ttfmp_rAF_3 58.8000000007014
     -->
    <script>


      const domNode = document.querySelector('#main-content');
      const io = new IntersectionObserver((entries, observer) => {
        console.log('ttfmp_io', performance.now());
        observer.unobserve(domNode);
      })
      io.observe(domNode);


      const domNode2 = document.querySelector('#sub-content');
      const io2 = new IntersectionObserver((entries, observer) => {
        console.log('ttfmp_io_sub', performance.now());
        console.log('ttfmp_io_sub', entries);
        observer.unobserve(domNode2);
      })
      io2.observe(domNode2);

      function ttfmp() {
        requestAnimationFrame(() => {
          console.log('ttfmp_rAF_1', performance.now());
          requestAnimationFrame(() => {
            console.log('ttfmp_rAF_2',  performance.now());
            requestAnimationFrame(() => {
              console.log('ttfmp_rAF_3',  performance.now());
            });
          });
        })
      }
      ttfmp();
    </script>
  </body>
</html>